load Area_Hyper.txt;
load Area_Arid.txt;
load Area_Semi.txt;
load Area_Sub.txt;
load Area_Humid.txt;
load Area_AI_all.txt;
load Length_Hyper.txt;
load Length_Arid.txt;
load Length_Semi.txt;
load Length_Sub.txt;
load Length_Humid.txt;
load Length_AI_all.txt;

hold on
%binscatter(Area_Hyper,Length_Hyper,[100 100])
%mymap = [0.67 0.61 0.47 ;0.64 0.57 0.42 ;0.61 0.54 0.38 ;0.58 0.51 0.33 ;0.56 0.48 0.29 ;0.53 0.44 0.24 ;0.50 0.41 0.20 ;0.47 0.38 0.15 ;0.45 0.35 0.11 ;0.42 0.31 0.06 ;0.39 0.28 0.02 ;0.37 0.26 0.02 ;0.35 0.25 0.02 ;0.33 0.23 0.02 ;0.30 0.22 0.02 ;0.28 0.20 0.01 ;0.26 0.19 0.01 ;0.24 0.17 0.01 ;0.22 0.16 0.01 ;0.20 0.14 0.01];
%binscatter(Area_Arid,Length_Arid,[100 100])
%mymap = [0.85 0.61 0.47 ;0.83 0.58 0.42 ;0.82 0.55 0.38 ;0.81 0.52 0.33 ;0.80 0.48 0.29 ;0.78 0.45 0.24 ;0.77 0.42 0.20 ;0.76 0.39 0.15 ;0.75 0.35 0.11 ;0.73 0.32 0.06 ;0.72 0.29 0.02 ;0.68 0.27 0.02 ;0.64 0.26 0.02 ;0.60 0.24 0.02 ;0.56 0.23 0.02 ;0.52 0.21 0.01 ;0.48 0.19 0.01 ;0.44 0.18 0.01 ;0.40 0.16 0.01 ;0.36 0.15 0.01];
%binscatter(Area_Semi,Length_Semi,[100 100])
%mymap = [0.98 0.79 0.59 ;0.98 0.77 0.55 ;0.97 0.75 0.52 ;0.97 0.73 0.48 ;0.97 0.72 0.45 ;0.97 0.70 0.41 ;0.97 0.68 0.38 ;0.97 0.66 0.34 ;0.96 0.65 0.31 ;0.96 0.63 0.27 ;0.96 0.61 0.24 ;0.91 0.58 0.23 ;0.85 0.54 0.21 ;0.80 0.51 0.20 ;0.75 0.47 0.19 ;0.69 0.44 0.17 ;0.64 0.41 0.16 ;0.59 0.37 0.15 ;0.53 0.34 0.13 ;0.48 0.31 0.12];
%binscatter(Area_Sub,Length_Sub,[100 100])
%mymap = [1.00 0.96 0.45 ;1.00 0.96 0.41 ;1.00 0.96 0.36 ;1.00 0.95 0.32 ;1.00 0.95 0.27 ;1.00 0.95 0.23 ;1.00 0.94 0.18 ;1.00 0.94 0.14 ;1.00 0.94 0.09 ;1.00 0.93 0.05 ;1.00 0.93 0.00 ;0.94 0.88 0.00 ;0.89 0.83 0.00 ;0.83 0.78 0.00 ;0.78 0.72 0.00 ;0.72 0.67 0.00 ;0.67 0.62 0.00 ;0.61 0.57 0.00 ;0.56 0.52 0.00 ;0.50 0.47 0.00];
binscatter(Area_Humid,Length_Humid,[100 100])
mymap = [1.00 0.98 0.86 ;1.00 0.98 0.85 ;1.00 0.98 0.84 ;1.00 0.98 0.83 ;1.00 0.98 0.82 ;1.00 0.98 0.81 ;1.00 0.98 0.80 ;1.00 0.97 0.78 ;1.00 0.97 0.77 ;1.00 0.97 0.76 ;1.00 0.97 0.75 ;0.94 0.92 0.71 ;0.89 0.86 0.67 ;0.83 0.81 0.63 ;0.78 0.75 0.58 ;0.72 0.70 0.54 ;0.67 0.65 0.50 ;0.61 0.59 0.46 ;0.56 0.54 0.42 ;0.50 0.49 0.38];
%binscatter(Area_AI_all,Length_AI_all,[100 100])
%mymap = [0.95 0.95 0.95 ;0.91 0.91 0.91 ;0.86 0.86 0.86 ;0.82 0.82 0.82 ;0.77 0.77 0.77 ;0.73 0.73 0.73 ;0.68 0.68 0.68 ;0.64 0.64 0.64 ;0.59 0.59 0.59 ;0.55 0.55 0.55 ;0.50 0.50 0.50 ;0.45 0.45 0.45 ;0.40 0.40 0.40 ;0.35 0.35 0.35 ;0.30 0.30 0.30 ;0.25 0.25 0.25 ;0.20 0.20 0.20 ;0.15 0.15 0.15 ;0.10 0.10 0.10 ;0.05 0.05 0.05];

colormap(mymap)

%Fit nonlinear regression model and plot
%modelfun = @(b,x)b(1)*x(:,1).^b(2)
%modelfun = @(b,x)0.51524*x(:,1).^b(2)
%beta0 = [0 0];
%mdl = fitnlm(Area_Humid,Length_Humid,modelfun,beta0)

x = [27 2200];
%plot(x,0.51524*x.^0.80751,'LineWidth',1,'Color',[0 0 0])
%plot(x,0.51524*x.^0.78532,'LineWidth',1,'Color',[0 0 0])
%plot(x,0.51524*x.^0.76768,'LineWidth',1,'Color',[0 0 0])
%plot(x,0.51524*x.^0.75944,'LineWidth',1,'Color',[0 0 0])
plot(x,0.51524*x.^0.7571,'LineWidth',1,'Color',[0 0 0])
%plot(x,0.51524*x.^0.76955,'LineWidth',1,'Color',[1 0 0])

xlabel('Drainage area (km^2)');
ylabel('River length (km)');
set(gca, 'XScale', 'log');
set(gca, 'YScale', 'log');
set(gca,'YMinorTick','on');
set(gca,'XMinorTick','on');
axis([27,2200,10^-1,10^3]);
c = colorbar;
c.Label.String = 'Bin counts';